"use strict";(self.webpackChunkgsrs_client=self.webpackChunkgsrs_client||[]).push([[9401],{39401:function(ce,S,f){f.d(S,{r:function(){return ue}});var _=f(78069),b=f(48047),h=f(95758),x=f(92938),e=f(76442),m=f(36362),Z=(f(27299),f(33567)),T=f(40104),k=f(18291),p=f(31631),O=f(21109),v=f(90587),y=f(87317),M=f(40089),w=f(65590),C=f(44770),I=f(43365),A=f(91434),F=f(1130);function q(s,u){if(1&s){var n=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"input",6),e.NdJ("ngModelChange",function(a){return e.CHM(n),e.oxw(2).manualInput(a)}),e.qZA(),e.qZA()}if(2&s){var t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.sitesDisplay)("ngClass",t.valid?"valid":"invalid")}}function P(s,u){if(1&s){var n=e.EpF();e.TgZ(0,"div",7),e.TgZ(1,"input",8),e.NdJ("ngModelChange",function(a){return e.CHM(n),e.oxw(2).manualInput(a)}),e.qZA(),e.TgZ(2,"div",9),e.TgZ(3,"button",10),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).clearSites()}),e._UZ(4,"mat-icon",11),e.qZA(),e.qZA(),e.TgZ(5,"div",12),e._uU(6),e.qZA(),e.qZA()}if(2&s){var t=e.oxw(2);e.Q6J("ngClass",t.valid?"valid":"invalid-cysteine"),e.xp6(1),e.Q6J("ngModel",t.sitesDisplay),e.xp6(5),e.Oqu(t.cysteineMessage)}}function U(s,u){if(1&s&&(e.TgZ(0,"div"),e._uU(1," Sites: "),e.YNc(2,q,2,2,"div",2),e.YNc(3,P,7,3,"div",5),e.qZA()),2&s){var n=e.oxw();e.xp6(2),e.Q6J("ngIf","disulfide"!==n.card),e.xp6(1),e.Q6J("ngIf","disulfide"===n.card)}}function N(s,u){if(1&s){var n=e.EpF();e.TgZ(0,"span",24),e.TgZ(1,"a",25),e.NdJ("click",function(){var o=e.CHM(n).$implicit;return e.oxw(2).deleteFeature(o)}),e._uU(2),e.qZA(),e.qZA()}if(2&s){var t=u.$implicit;e.xp6(2),e.HOy(" ",t[0].subunitIndex,"_",t[0].residueIndex,"-",t[1].subunitIndex,"_",t[1].residueIndex,"; ")}}function D(s,u){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){var n=e.oxw(2);e.xp6(1),e.AsE(" ",n.newFeature[0].subunitIndex,"_",n.newFeature[0].residueIndex," - ")}}function J(s,u){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){var n=e.oxw(2);e.xp6(1),e.AsE(" ",n.newFeature[1].subunitIndex,"_",n.newFeature[1].residueIndex," ")}}function E(s,u){1&s&&(e.TgZ(0,"span"),e._uU(1,"Select Starting Site"),e.qZA())}function Q(s,u){1&s&&(e.TgZ(0,"span"),e._uU(1,"Select Ending Site"),e.qZA())}function Y(s,u){1&s&&(e.TgZ(0,"span"),e._uU(1,"Enter a Feature Name "),e.qZA())}function R(s,u){1&s&&(e.TgZ(0,"span"),e._uU(1,"Click a new site to add an additional range"),e.qZA())}function G(s,u){if(1&s){var n=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",13),e.TgZ(2,"mat-form-field",14),e.TgZ(3,"mat-label"),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"input",15),e.NdJ("ngModelChange",function(a){return e.CHM(n),e.oxw().featureName=a})("change",function(a){return e.CHM(n),e.oxw().emitUpdate(a)}),e.qZA(),e.qZA(),e.TgZ(6,"div",16),e.TgZ(7,"div",17),e._uU(8," Site Range "),e.qZA(),e.TgZ(9,"div",18),e.YNc(10,N,3,4,"span",19),e.TgZ(11,"span",20),e.YNc(12,D,2,2,"span",2),e.YNc(13,J,2,2,"span",2),e.qZA(),e.qZA(),e.TgZ(14,"div",9),e.TgZ(15,"button",21),e.NdJ("click",function(){return e.CHM(n),e.oxw().removeFeature()}),e._UZ(16,"mat-icon",11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",22),e.TgZ(18,"div",23),e.YNc(19,E,2,0,"span",2),e.YNc(20,Q,2,0,"span",2),e.YNc(21,Y,2,0,"span",2),e.YNc(22,R,2,0,"span",2),e.qZA(),e.qZA(),e.qZA()}if(2&s){var t=e.oxw();e.xp6(5),e.Q6J("ngModel",t.featureName),e.xp6(5),e.Q6J("ngForOf",t.newFeatureArray),e.xp6(2),e.Q6J("ngIf",t.newFeature[0]),e.xp6(1),e.Q6J("ngIf",t.newFeature[1]),e.xp6(6),e.Q6J("ngIf","first"==t.selectState),e.xp6(1),e.Q6J("ngIf","last"==t.selectState),e.xp6(1),e.Q6J("ngIf","finished"==t.selectState&&(""===t.featureName||null===t.featureName)),e.xp6(1),e.Q6J("ngIf","finished"==t.selectState)}}function j(s,u){if(1&s){var n=e.EpF();e.TgZ(0,"span",24),e.TgZ(1,"a",25),e.NdJ("click",function(){var o=e.CHM(n).index;return e.oxw(2).deleteDisulfide(o)}),e._uU(2),e.qZA(),e.qZA()}if(2&s){var t=u.$implicit;e.xp6(2),e.HOy(" ",t[0].subunitIndex,"_",t[0].residueIndex,", ",t[1].subunitIndex,"_",t[1].residueIndex,"; ")}}function H(s,u){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){var n=e.oxw(2);e.xp6(1),e.AsE(" ",n.sites[0].subunitIndex,"_",n.sites[0].residueIndex," - ")}}function $(s,u){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){var n=e.oxw(2);e.xp6(1),e.AsE(" ",n.sites[1].subunitIndex,"_",n.sites[1].residueIndex," ")}}function z(s,u){1&s&&(e.TgZ(0,"div",27),e._uU(1,"click on a link above to delete it, or another starting site to add additional links"),e.qZA())}function L(s,u){1&s&&(e.TgZ(0,"div"),e._uU(1,"Click on a starting site, then an ending site to create a new link"),e.qZA())}function V(s,u){if(1&s&&(e.TgZ(0,"div"),e.TgZ(1,"b"),e._uU(2,"Links:"),e.qZA(),e.YNc(3,j,3,4,"span",19),e.TgZ(4,"span",20),e.YNc(5,H,2,2,"span",2),e.YNc(6,$,2,2,"span",2),e.qZA(),e._UZ(7,"br"),e.YNc(8,z,2,0,"div",26),e.YNc(9,L,2,0,"div",2),e.qZA()),2&s){var n=e.oxw();e.xp6(3),e.Q6J("ngForOf",n.disulfideArray),e.xp6(2),e.Q6J("ngIf",n.sites[0]),e.xp6(1),e.Q6J("ngIf",n.newFeature[1]),e.xp6(2),e.Q6J("ngIf",n.disulfideArray&&n.disulfideArray.length>0),e.xp6(1),e.Q6J("ngIf",!n.disulfideArray||0===n.disulfideArray.length)}}function B(s,u){if(1&s){var n=e.EpF();e.TgZ(0,"div",28),e.TgZ(1,"mat-form-field",29),e.TgZ(2,"mat-label"),e._uU(3,"Select link type to add"),e.qZA(),e.TgZ(4,"mat-select",30),e.NdJ("valueChange",function(i){return e.CHM(n),e.oxw().switchType(i)}),e.TgZ(5,"mat-option",31),e.TgZ(6,"span"),e._uU(7,"Other Link"),e.qZA(),e.qZA(),e.TgZ(8,"mat-option",32),e.TgZ(9,"span"),e._uU(10,"C-Glycosylation Sites"),e.qZA(),e.qZA(),e.TgZ(11,"mat-option",33),e.TgZ(12,"span"),e._uU(13,"N-Glycosylation Sites"),e.qZA(),e.qZA(),e.TgZ(14,"mat-option",34),e.TgZ(15,"span"),e._uU(16,"O-Glycosylation Sites"),e.qZA(),e.qZA(),e.TgZ(17,"mat-option",35),e.TgZ(18,"span"),e._uU(19,"Disulfide Link"),e.qZA(),e.qZA(),e.TgZ(20,"mat-option",36),e.TgZ(21,"span"),e._uU(22,"Structural Modification"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}}function X(s,u){1&s&&(e.TgZ(0,"div",37),e._uU(1," Key: "),e._UZ(2,"br"),e.TgZ(3,"div",38),e.TgZ(4,"div",39),e._UZ(5,"div",40),e._uU(6,"C-Glycosylation"),e.qZA(),e.TgZ(7,"div",39),e._UZ(8,"div",41),e._uU(9,"Other Link"),e.qZA(),e.qZA(),e.TgZ(10,"div",38),e.TgZ(11,"div",39),e._UZ(12,"div",42),e._uU(13,"O-Glycosylation"),e.qZA(),e.TgZ(14,"div",39),e._UZ(15,"div",43),e._uU(16,"Modification"),e.qZA(),e.qZA(),e.TgZ(17,"div",38),e.TgZ(18,"div",39),e._UZ(19,"div",44),e._uU(20,"N-Glycosylation"),e.qZA(),e.TgZ(21,"div",39),e._UZ(22,"div",45),e._uU(23,"Disulfide Link"),e.qZA(),e.qZA(),e.TgZ(24,"div",38),e.TgZ(25,"div",39),e._UZ(26,"div",46),e._uU(27,"Feature"),e.qZA(),e.TgZ(28,"div",39),e._UZ(29,"div",47),e._uU(30,"currently selected"),e.qZA(),e.qZA(),e.qZA())}function W(s,u){if(1&s){var n=e.EpF();e.TgZ(0,"span",58),e.TgZ(1,"a",59),e.NdJ("click",function(r){var g=e.CHM(n).$implicit,le=e.oxw(3).$implicit;return e.oxw(2).toggleSite(le.subunitIndex,g.unitIndex,g.unitValue,r)}),e._uU(2),e.qZA(),e.qZA()}if(2&s){var t=u.$implicit,i=e.oxw().last,a=e.oxw().last,o=e.oxw().$implicit,c=e.oxw(2);e.Q6J("ngClass",a&&i?"last-units":""),e.xp6(1),e.s9C("matTooltip",c.getTooltipMessage(o.subunitIndex,t.unitIndex,t.unitValue,t.class||"").join("\n")),e.Q6J("id",o.subunitIndex+"_"+t.unitIndex)("ngClass",t.class)("@errorFlash",void 0),e.xp6(1),e.Oqu(t.unitValue)}}function K(s,u){if(1&s&&(e.TgZ(0,"div",54),e.TgZ(1,"div",55),e._uU(2),e.qZA(),e.TgZ(3,"div",56),e.YNc(4,W,3,6,"span",57),e.qZA(),e.qZA()),2&s){var n=u.$implicit,t=u.last,i=e.oxw().last,a=e.oxw().$implicit;e.Q6J("ngClass",i&&t?"last-section":""),e.xp6(2),e.Oqu(n[1]),e.xp6(2),e.Q6J("ngForOf",a.subunits.slice(n[0],n[1]))}}function ee(s,u){if(1&s&&(e.TgZ(0,"div",52),e.YNc(1,K,5,3,"div",53),e.qZA()),2&s){var n=u.$implicit;e.xp6(1),e.Q6J("ngForOf",n)}}function te(s,u){if(1&s&&(e.TgZ(0,"div",49),e.TgZ(1,"h4"),e._uU(2),e.qZA(),e.TgZ(3,"div",50),e.YNc(4,ee,2,1,"div",51),e.qZA(),e.qZA()),2&s){var n=u.$implicit;e.xp6(2),e.hij("Subunit ",n.subunitIndex,""),e.xp6(2),e.Q6J("ngForOf",n.subsections)}}function ie(s,u){if(1&s&&(e.TgZ(0,"span"),e.YNc(1,te,5,2,"div",48),e.qZA()),2&s){var n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.subunitSequences)}}function ne(s,u){if(1&s&&(e.TgZ(0,"div"),e._uU(1," Total sequence length of "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4," is too long to display. Please enter sites manually "),e.qZA()),2&s){var n=e.oxw();e.xp6(3),e.Oqu(n.siteTotal)}}var se=function(){var s=function(){function u(n,t,i,a,o){(0,_.Z)(this,u),this.substanceFormService=n,this.substanceFormLinksService=t,this.gaService=i,this.cvService=a,this.render=o,this.sitesUpdate=new e.vpe,this.featureUpdate=new e.vpe,this.disulfidesUpdate=new e.vpe,this.cardTypeUpdate=new e.vpe,this.privateFeature={name:"",siteRange:""},this.sites=[],this.allSites=[],this.vocabulary={},this.subscriptions=[],this.newFeature=[],this.subunitSequences=[],this.currentState="initial",this.newFeatureArray=[],this.valid=!0,this.disulfideArray=[],this.showStyle=!0}return(0,b.Z)(u,[{key:"feature",get:function(){return this.privateFeature},set:function(t){this.privateFeature=t}},{key:"ngOnInit",value:function(){var t=this;this.substanceFormService.definition.subscribe(function(a){t.substanceType=a.substanceClass}).unsubscribe(),this.getVocabularies(),this.link&&this.link.length>0?(this.sites=this.link,this.allSites=[],this.updateDisplay(),this.sitesUpdate.emit(this.sites)):this.link=[],this.feature&&this.convertFeature(),this.selectState="first",this.startingCard=this.card}},{key:"ngAfterViewInit",value:function(){var t=this;this.siteTotal=0,this.link.length&&0!==this.link.length?1===this.link.length?this.selectState="last":2===this.link.length&&(this.selectState="finished"):this.selectState="first",setTimeout(function(){var i=t.substanceFormService.subunitDisplaySequences.subscribe(function(l){t.subunitSequences=l,t.subunitSequences.forEach(function(r){t.siteTotal=t.siteTotal+r.subunits.length,"disulfide"===t.card&&r.subunits.forEach(function(d){d.class="C"!==d.unitValue?"unavailable":"cys"}),t.showStyle=!(t.siteTotal>5e3)}),t.feature&&t.convertFeature()});t.subscriptions.push(i);var a=t.substanceFormService.allSites.subscribe(function(l){t.allSites=t.allSites.concat(l)});if(t.subscriptions.push(a),"link"===t.card){var o=t.substanceFormLinksService.substanceLinks.subscribe(function(l){l.forEach(function(r){r.sites&&r.sites.forEach(function(d){t.allSites.push({residue:d.residueIndex,subunit:d.subunitIndex,type:"other"})})})});t.subscriptions.push(o)}else if("sugar"===t.card){var c=t.substanceFormService.substanceSugars.subscribe(function(l){l.forEach(function(r){r.sites&&r.sites.forEach(function(d){t.allSites.push({residue:d.residueIndex,subunit:d.subunitIndex,type:"other"})})})});t.subscriptions.push(c)}setTimeout(function(){t.addStyle()},100)})}},{key:"ngOnDestroy",value:function(){this.subscriptions.forEach(function(t){t.unsubscribe()})}},{key:"emitUpdate",value:function(t){this.privateFeature||(this.privateFeature={name:this.featureName,siteRange:""}),this.featureUpdate.emit(this.privateFeature),this.privateFeature.name=this.featureName}},{key:"getVocabularies",value:function(){var t=this;this.cvService.getDomainVocabulary("AMINO_ACID_RESIDUE").subscribe(function(i){t.vocabulary=i.AMINO_ACID_RESIDUE.dictionary},function(i){})}},{key:"switchType",value:function(t){var i=t;this.card=i,this.sites=[],this.features=[],this.sitesDisplay="",this.selectState="first",this.cardTypeUpdate.emit(i),this.addStyle()}},{key:"getTooltipMessage",value:function(t,i,a,o){var c=void 0===this.vocabulary[a]?"UNDEFINED":this.vocabulary[a].display,l=[],r={modification:"Structural Modification",other:"Other Link","C-Glycosylation":"C-Glycosylation","N-Glycosylation":"N-Glycosylation","O-Glycosylation":"O-Glycosylation",feature:this.substanceType.toUpperCase()+" Feature",disulfide:"Disulfide Link"};return l.push("".concat(t," - ").concat(i,": ").concat(a.toUpperCase()," (").concat(c,")")),o.split(" ").forEach(function(g){l.push(r[g]||"")}),l}},{key:"updateDisplay",value:function(){this.sites=this.sites.sort(function(t,i){return t.subUnitIndex>i.subunitIndex?1:t.subunitIndex<i.subunitIndex?-1:t.residueIndex>i.residueIndex?1:t.residueIndex<i.residueIndex?void 0:1}),this.sitesDisplay=this.substanceFormService.siteString(this.sites)}},{key:"toggleMultiDisulfide",value:function(t,i,a,o){var c={subunitIndex:t,residueIndex:i,event:o.target};"first"===this.selectState?(this.sites[0]=c,this.render.addClass(o.target,"chosen"),this.selectState="last"):"last"===this.selectState&&(this.sites[0]===c?(this.selectState="first",this.render.removeClass(o.target,"chosen")):(this.sites[1]=c,this.disulfideArray.push(this.sites),this.sites=[],this.selectState="first",this.renderDisulfideArray(),this.disulfidesUpdate.emit(this.disulfideArray)))}},{key:"deleteDisulfide",value:function(t){var i=this;this.disulfideArray[t].forEach(function(a){i.render.removeClass(a.event,"new-disulfide")}),this.disulfideArray.splice(t,1),this.disulfidesUpdate.emit(this.disulfideArray)}},{key:"renderDisulfideArray",value:function(){var t=this;this.disulfideArray.forEach(function(i){i.forEach(function(a){t.render.removeClass(a.event,"chosen"),t.render.addClass(a.event,"new-disulfide")})})}},{key:"toggleSite",value:function(t,i,a,o){var c={subunitIndex:t,residueIndex:i};if("feature"===this.card)this.toggleFeatureSite(t,i,a,o);else if("multi-disulfide"===this.card)this.toggleMultiDisulfide(t,i,a,o);else{var l=this.sites.some(function(r){return r.residueIndex===i&&r.subunitIndex===t});"disulfide"!==this.card?(l?(this.sites=this.sites.filter(function(r){return r.residueIndex!==i||r.subunitIndex!==t}),this.render.removeClass(o.target,"chosen")):(this.sites.push(c),this.render.addClass(o.target,"chosen")),this.updateDisplay(),this.sitesUpdate.emit(this.sites)):((l||"finished"!==this.selectState)&&this.render.removeClass(o.target,"chosen"),"C"===o.target.innerText?("first"===this.selectState?l?(this.render.removeClass(o.target,"chosen"),this.sites=this.sites.filter(function(r){return r.residueIndex!==i||r.subunitIndex!==t})):(this.selectState="last",this.render.addClass(o.target,"chosen"),this.sites[0]=c):"last"===this.selectState?l?(this.selectState="first",this.sites=[],this.render.removeClass(o.target,"chosen")):(this.selectState="finished",this.sites[1]=c,this.render.addClass(o.target,"chosen")):"finished"===this.selectState&&(l?(this.selectState="last",this.sites=this.sites.filter(function(r){return r.residueIndex!==i||r.subunitIndex!==t})):this.cysteineMessage="You must clear existing sites to select new ones"),this.updateDisplay(),this.sitesUpdate.emit(this.sites)):(this.render.addClass(o.target,"invalid_blink"),setTimeout(function(){this.render.removeClass(o.target,"invalid_blink")},2e3)))}}},{key:"clearSites",value:function(){var t=this;this.sites.forEach(function(i){t.subunitSequences[i.subunitIndex-1].subunits[i.residueIndex-1].class=""}),this.sites=[],this.cysteineMessage="",this.selectState="first",this.updateDisplay()}},{key:"addStyle",value:function(){var t=this;this.subunitSequences&&this.subunitSequences[0]&&this.subunitSequences[0].subunits&&(this.subunitSequences.forEach(function(i){i.subunits.forEach(function(a){a.class="disulfide"===t.card||"multi-disulfide"===t.card?"C"!==a.unitValue?"unavailable":"cys":""})}),this.allSites.forEach(function(i){t.subunitSequences[i.subunit-1].subunits&&t.subunitSequences[i.subunit-1].subunits[i.residue-1]&&(t.subunitSequences[i.subunit-1].subunits[i.residue-1].class=""!==t.subunitSequences[i.subunit-1].subunits[i.residue-1].class?t.subunitSequences[i.subunit-1].subunits[i.residue-1].class+" "+i.type:i.type)}),this.sites.forEach(function(i){t.subunitSequences[i.subunitIndex-1].subunits&&(t.subunitSequences[i.subunitIndex-1].subunits[i.residueIndex-1].class="chosen")}),this.features&&this.features.forEach(function(i){t.drawFeature(i)}))}},{key:"manualInput",value:function(t){try{var i=this.substanceFormService.stringToSites(t.replace(/ /g,""));this.sites!==i&&("disulfide"===this.card?i.length<3&&i.length>0?(this.sites[0]=i[0]?i[0]:{},this.sites[1]=i[1]?i[1]:{},this.valid=!0,this.sitesDisplay=t,this.addStyle()):this.valid=!1:(this.sites=i,this.addStyle(),this.sitesUpdate.emit(this.sites))),this.valid=!0,this.sitesDisplay=t}catch(a){console.log(a),this.valid=!1}}},{key:"removeFeature",value:function(){this.newFeature[1]?(this.addFeature(this.newFeature,!0),this.addStyle(),this.selectState="first"):this.newFeature[0]&&(this.subunitSequences[this.newFeature[0].subunitIndex-1].subunits[this.newFeature[0].residueIndex-1].class=""),this.newFeature=[]}},{key:"addFeature",value:function(t,i){if(t[0].subunitIndex===t[1].subunitIndex){var a=t[0].subunitIndex,o=t[0].residueIndex,c=t[1].residueIndex;t[0].residueIndex>t[1].residueIndex&&(o=t[1].residueIndex,c=t[0].residueIndex);for(var l=o;l<=c;l++)this.subunitSequences[a-1].subunits[l-1].class=i?"":"chosen"}}},{key:"deleteFeature",value:function(t){for(var i=t[0].residueIndex;i<=t[1].residueIndex;i++)this.subunitSequences[t[0].subunitIndex-1].subunits[i-1].class="";this.newFeatureArray=this.newFeatureArray.filter(function(a){return t[0]!==a[0]&&t[1]!==a[1]})}},{key:"pushFeature",value:function(){2===this.newFeature.length&&(this.newFeatureArray.push(this.newFeature),this.newFeature=[],this.selectState="first")}},{key:"drawFeature",value:function(t){for(var i=t.siteRange.split("-"),a=Number(i[0].split("_")[1]),o=Number(i[1].split("_")[1]),c=Number(i[0].split("_")[0]),l=a;l<=o;l++)this.subunitSequences[c-1].subunits[l-1].class="feature"}},{key:"toggleFeatureSite",value:function(t,i,a,o){var c={subunitIndex:t,residueIndex:i};if("first"===this.selectState)this.newFeature[0]=c,this.render.addClass(o.target,"chosen"),this.selectState="last";else if("last"===this.selectState)if(this.newFeature[0].subunitIndex===c.subunitIndex&&this.newFeature[0].residueIndex===c.residueIndex)this.selectState="first",this.render.removeClass(o.target,"chosen");else{this.newFeature[1]=c,this.addFeature(this.newFeature),this.selectState="finished";var l="";this.newFeatureArray.forEach(function(d){l=l+(d[0].subunitIndex+"_")+d[0].residueIndex+"-"+d[1].subunitIndex+"_"+d[1].residueIndex+";"}),this.privateFeature={name:this.featureName||"",siteRange:l=l+(this.newFeature[0].subunitIndex+"_")+this.newFeature[0].residueIndex+"-"+this.newFeature[1].subunitIndex+"_"+this.newFeature[1].residueIndex},this.featureUpdate.emit(this.privateFeature)}else if("finished"===this.selectState){this.pushFeature(),this.newFeature[0]=c,this.render.addClass(o.target,"chosen"),this.selectState="last";var r="";this.newFeatureArray.forEach(function(d){r=r+(d[0].subunitIndex+"_")+d[0].residueIndex+"-"+d[1].subunitIndex+"_"+d[1].residueIndex}),this.privateFeature={name:this.featureName||"",siteRange:r},this.featureUpdate.emit(this.privateFeature)}}},{key:"convertFeature",value:function(){var t=this;this.newFeatureArray=[],this.feature.siteRange.split(";").forEach(function(a){var o=a.split("-"),c=Number(o[0].split("_")[1]),l=Number(o[1].split("_")[1]),r=Number(o[0].split("_")[0]),d=[{subunitIndex:r,residueIndex:c},{subunitIndex:r,residueIndex:l}];t.newFeatureArray.push(d),t.addFeature(d)}),this.newFeature=[],this.featureName=this.feature.name,this.selectState="first"}}]),u}();return s.\u0275fac=function(n){return new(n||s)(e.Y36(Z.B),e.Y36(O.e),e.Y36(T.$),e.Y36(k.I),e.Y36(e.Qsj))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-subunit-selector"]],inputs:{card:"card",link:"link",feature:"feature"},outputs:{sitesUpdate:"sitesUpdate",featureUpdate:"featureUpdate",disulfidesUpdate:"disulfidesUpdate",cardTypeUpdate:"cardTypeUpdate"},decls:10,vars:7,consts:[[1,"form-header"],[1,"form-input"],[4,"ngIf"],["class","card-selector",4,"ngIf"],["class","key-row",4,"ngIf"],["class","disulfide-form",3,"ngClass",4,"ngIf"],[1,"sites-input",3,"ngModel","ngClass","ngModelChange"],[1,"disulfide-form",3,"ngClass"],[1,"sites-input","disulfide-display",3,"ngModel","ngModelChange"],[1,"clear-button"],["mat-icon-button","","matTooltip","Clear Selection",3,"click"],["svgIcon","clear"],[1,"cysteine-message"],[1,"form-row-feature"],[1,"name-type","mat-form-field"],["matInput","","placeholder","Name","name","name",1,"sites-input",3,"ngModel","ngModelChange","change"],[1,"key-value-pair"],[1,"key"],[1,"value"],["class","link-cont",4,"ngFor","ngForOf"],[1,"bold"],["mat-icon-button","","matTooltip","Clear Current Selection",3,"click"],[1,"form-row-2"],[1,"feature-step"],[1,"link-cont"],["matTooltip","Delete sequence section",1,"featlink",3,"click"],["class","note",4,"ngIf"],[1,"note"],[1,"card-selector"],[1,"top-padding"],["name","food",3,"valueChange"],["value","other","disabled",""],["value","CGlycosylation"],["value","NGlycosylation"],["value","OGlycosylation"],["value","disulfide"],["value","modification","disabled",""],[1,"key-row"],[1,"key-container"],[1,"key-label"],[1,"C-Glycosylation","key-color"],[1,"other","key-color"],[1,"O-Glycosylation","key-color"],[1,"modification","key-color"],[1,"N-Glycosylation","key-color"],[1,"disulfide","key-color"],[1,"feature","key-color"],[1,"chosen","key-color"],["class","subunit-sequence",4,"ngFor","ngForOf"],[1,"subunit-sequence"],[1,"responsive"],["class","sequence-section-group",4,"ngFor","ngForOf"],[1,"sequence-section-group"],["class","sequence-section",3,"ngClass",4,"ngFor","ngForOf"],[1,"sequence-section",3,"ngClass"],[1,"section-number"],[1,"section-units-container"],["class","section-unit",3,"ngClass",4,"ngFor","ngForOf"],[1,"section-unit",3,"ngClass"],["matTooltipClass","unit-tooltip",1,"selectedSite","siteref",3,"id","ngClass","matTooltip","click"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,U,4,2,"div",2),e.YNc(3,G,23,8,"div",2),e.YNc(4,V,10,5,"div",2),e.YNc(5,B,23,0,"div",3),e.qZA(),e.YNc(6,X,31,0,"div",4),e.qZA(),e.TgZ(7,"mat-dialog-content"),e.YNc(8,ie,2,1,"span",2),e.YNc(9,ne,5,1,"div",2),e.qZA()),2&n&&(e.xp6(2),e.Q6J("ngIf","feature"!==t.card&&"multi-disulfide"!==t.card),e.xp6(1),e.Q6J("ngIf","feature"==t.card),e.xp6(1),e.Q6J("ngIf","multi-disulfide"===t.card),e.xp6(1),e.Q6J("ngIf","any"===t.startingCard),e.xp6(1),e.Q6J("ngIf","protein"===t.substanceType),e.xp6(2),e.Q6J("ngIf",t.showStyle),e.xp6(1),e.Q6J("ngIf",!t.showStyle))},directives:[m.O5,v.Fj,v.JJ,v.On,m.mk,y.lW,M.gM,w.Hw,C.KE,C.hX,I.Nt,m.sg,A.gD,F.ey,h.xY],styles:[".details[_ngcontent-%COMP%]   .subunit[_ngcontent-%COMP%]{display:none}.details[_ngcontent-%COMP%]   .subunit-sequence[_ngcontent-%COMP%]{display:block;box-sizing:border-box}.form-fields[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0px}.sites-input[_ngcontent-%COMP%]{width:70%}.show[_ngcontent-%COMP%]{display:block}.hide[_ngcontent-%COMP%]{display:none}.top-padding[_ngcontent-%COMP%]{padding-top:10px}.raw[_ngcontent-%COMP%]   .subunit[_ngcontent-%COMP%]{display:block;box-sizing:border-box}.raw[_ngcontent-%COMP%]   .subunit[_ngcontent-%COMP%]{display:block}.raw[_ngcontent-%COMP%]   .subunit-sequence[_ngcontent-%COMP%]{display:none}.subunit-sequence[_ngcontent-%COMP%]{margin-bottom:30px}.sequence-section-group[_ngcontent-%COMP%]{width:100%;display:-ms-flexbox;display:flex;margin-bottom:10px}.section-number[_ngcontent-%COMP%]{text-align:right;padding:0 10px;font-size:.8em}.sequence-section[_ngcontent-%COMP%]{-ms-flex-positive:0;flex-grow:0;padding:0 10px;-ms-flex-preferred-size:20%;flex-basis:20%;-ms-flex-negative:0;flex-shrink:0}.section-units-container[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex}.section-units-container[_ngcontent-%COMP%]   .section-unit[_ngcontent-%COMP%]:hover{cursor:default}.subunit[_ngcontent-%COMP%]{padding-top:5px;padding-bottom:20px}.subunit[_ngcontent-%COMP%]:not(:last-child){border-bottom:solid 1px rgba(0,0,0,.12)}.raw-sequence[_ngcontent-%COMP%]{word-break:break-all;line-height:26px}.filters-container[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end}.subunit-form-container[_ngcontent-%COMP%]{padding:30px 10px 12px;position:relative}.notification-backdrop[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;display:-ms-flexbox;display:flex;z-index:10;background-color:#fffc;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;font-size:30px;font-weight:700;color:#666}.form-row-2[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.delete-container[_ngcontent-%COMP%]{padding:0 10px 8px 0}.form-header[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex}.form-header[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:75%}.form-header[_ngcontent-%COMP%]   .key-row[_ngcontent-%COMP%]{width:25%}.key-row[_ngcontent-%COMP%]{-ms-flex-pack:end;justify-content:flex-end;-ms-flex-align:end;align-items:flex-end;width:100%}.key-row[_ngcontent-%COMP%]   .key-container[_ngcontent-%COMP%]{width:250px;-ms-flex-align:end;align-items:flex-end;display:-ms-flexbox;display:flex;font-size:13px}.key-row[_ngcontent-%COMP%]   .key-container[_ngcontent-%COMP%]   .key-label[_ngcontent-%COMP%]{width:125px;display:-ms-flexbox;display:flex;padding-bottom:5px}.unit-tooltip[_ngcontent-%COMP%], .mat-tooltip[_ngcontent-%COMP%]{white-space:pre-line!important}.key-color[_ngcontent-%COMP%]{width:15px;height:18px;padding-right:5px}.disulfide[_ngcontent-%COMP%]{color:#fff;background-color:#cca300}.other[_ngcontent-%COMP%]{color:#fff;background-color:#483d8b}.glycosylation[_ngcontent-%COMP%]{color:#fff;background-color:#608000}.N-Glycosylation[_ngcontent-%COMP%]{color:#fff;background-color:#06c}.C-Glycosylation[_ngcontent-%COMP%]{color:#fff;background-color:gray}.O-Glycosylation[_ngcontent-%COMP%]{color:#fff;background-color:#f66}.feature[_ngcontent-%COMP%]{border-top:1px solid magenta;border-bottom:1px solid magenta}.modification[_ngcontent-%COMP%]{color:#fff;background-color:#006400}.chosen[_ngcontent-%COMP%]{color:#000!important;background-color:#40e0d0!important}.new-disulfide[_ngcontent-%COMP%]{color:#000!important;background-color:#87cefa!important}.selectedSite[_ngcontent-%COMP%]{padding-left:1px;padding-right:1px}.feature-step[_ngcontent-%COMP%]{width:50%;font-size:15px}.feature-display[_ngcontent-%COMP%]{width:30%}.name-type[_ngcontent-%COMP%]{width:40%;padding-right:50px}.key-value-pair[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-item-align:start;align-self:flex-start;width:50%}.key-value-pair[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{font-size:11px;padding-bottom:3.5px;line-height:11px;color:#0000008a;font-weight:400;font-family:Roboto,Helvetica Neue,sans-serif;width:55px}.key-value-pair[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:15px}.key-value-pair[_ngcontent-%COMP%]   .bold[_ngcontent-%COMP%]{font-weight:700}.siteref[_ngcontent-%COMP%]{display:block;width:15.5px!important;text-align:center}.featlink[_ngcontent-%COMP%]{padding-right:7px;color:#4793d1}.featlink[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{font-weight:700}.form-row[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:end;align-items:flex-end}.form-row[_ngcontent-%COMP%]   .delete-container[_ngcontent-%COMP%]{padding:0 10px 8px 0}.form-row[_ngcontent-%COMP%]   .code-system[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .code-system-type[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1;padding-right:15px}.form-row[_ngcontent-%COMP%]   .code-text[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .url[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1}.form-row-feature[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:start;justify-content:flex-start}.form-row-feature[_ngcontent-%COMP%]   .delete-container[_ngcontent-%COMP%]{padding:0 10px 8px 0}.form-row-feature[_ngcontent-%COMP%]   .code-system[_ngcontent-%COMP%], .form-row-feature[_ngcontent-%COMP%]   .code-system-type[_ngcontent-%COMP%], .form-row-feature[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1;padding-right:15px}.form-row-feature[_ngcontent-%COMP%]   .code-text[_ngcontent-%COMP%], .form-row-feature[_ngcontent-%COMP%]   .url[_ngcontent-%COMP%]{-ms-flex-positive:1;flex-grow:1}.clear-button[_ngcontent-%COMP%]{width:40px}.disulfide-form[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;-ms-flex-pack:start;justify-content:flex-start}.disulfide-display[_ngcontent-%COMP%]{width:100px}.cys[_ngcontent-%COMP%]{color:#000;font-weight:500}.unavailable[_ngcontent-%COMP%]{color:#d3d3d3!important}.invalid_blink[_ngcontent-%COMP%]{-webkit-animation:blinker .5s linear 1;animation:blinker .5s linear 1}@-webkit-keyframes blinker{50%{opacity:0}}@keyframes blinker{50%{opacity:0}}.invalid[_ngcontent-%COMP%]{border:solid red;color:red}.valid[_ngcontent-%COMP%]{color:#000}.invalid-cysteine[_ngcontent-%COMP%]{color:red}.last-section[_ngcontent-%COMP%]{-ms-flex-preferred-size:0!important;flex-basis:0!important}.note[_ngcontent-%COMP%]{padding-top:10px;padding-left:15px;font-size:14px}"],data:{animation:[(0,p.X$)("errorFlash",[(0,p.SB)("initial",(0,p.oB)({backgroundColor:"white"})),(0,p.SB)("final",(0,p.oB)({backgroundColor:"pink"})),(0,p.eR)("initial=>final",(0,p.jt)("1000ms")),(0,p.eR)("final=>initial",(0,p.jt)("500ms"))])]}}),s}();function ae(s,u){1&s&&(e.TgZ(0,"h1",5),e._uU(1,"Select Sites"),e.qZA())}function oe(s,u){1&s&&(e.TgZ(0,"h1",5),e._uU(1,"Add / Modify Feature"),e.qZA())}var ue=function(){var s=function(){function u(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,_.Z)(this,u),this.dialogRef=n,this.data=t,this.warning="",n.disableClose=!0}return(0,b.Z)(u,[{key:"ngOnInit",value:function(){var t=this;this.dialogRef.backdropClick().subscribe(function(i){"feature"===t.data.card?t.feature&&t.feature.name&&""!==t.feature.name&&t.feature.siteRange?t.dialogRef.close(t.feature):t.invalidFeatureConfirm():t.dialogRef.close("multi-disulfide"===t.data.card?t.disulfides:t.data.links)})}},{key:"invalidFeatureConfirm",value:function(){confirm("Feature is missing information and will not be saved. Close the dialog anyway?")&&this.dialogRef.close()}},{key:"ngAfterViewInit",value:function(){"feature"===this.data.card?this.backup=this.feature&&this.feature.name&&""!==this.feature.name&&this.feature.siteRange?JSON.parse(JSON.stringify(this.feature)):{}:"multi-disulfide"===this.data.card?this.backup=(0,x.cloneDeep)(this.disulfides):(Object.assign([],this.data.links),this.backup=(0,x.cloneDeep)(this.data.links))}},{key:"save",value:function(){"feature"===this.data.card?this.feature&&this.feature.name&&""!==this.feature.name?this.feature.siteRange?this.dialogRef.close(this.feature):this.warning="Select site Range(s) before saving":this.warning="Enter a feature name before saving":this.dialogRef.close("multi-disulfide"===this.data.card?this.disulfides:"any"===this.data.card?this.data:this.data.links)}},{key:"cancel",value:function(){this.dialogRef.close(this.backup)}},{key:"updateSites",value:function(t){this.data.links=t}},{key:"updateFeature",value:function(t){this.feature=t,this.data.sentFeature=t}},{key:"updateDisulfides",value:function(t){this.disulfides=t}},{key:"updateCardType",value:function(t){this.data.siteType=t}}]),u}();return s.\u0275fac=function(n){return new(n||s)(e.Y36(h.so),e.Y36(h.WI))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-subunit-selector-dialog"]],decls:11,vars:6,consts:[["mat-dialog-title","",4,"ngIf"],[3,"card","link","feature","disulfidesUpdate","sitesUpdate","featureUpdate","cardTypeUpdate"],[1,"actions"],["mat-button","",3,"click"],[1,"warning"],["mat-dialog-title",""]],template:function(n,t){1&n&&(e.YNc(0,ae,2,0,"h1",0),e.YNc(1,oe,2,0,"h1",0),e.TgZ(2,"app-subunit-selector",1),e.NdJ("disulfidesUpdate",function(a){return t.updateDisulfides(a)})("sitesUpdate",function(a){return t.updateSites(a)})("featureUpdate",function(a){return t.updateFeature(a)})("cardTypeUpdate",function(a){return t.updateCardType(a)}),e.qZA(),e.TgZ(3,"mat-dialog-actions"),e.TgZ(4,"div",2),e.TgZ(5,"button",3),e.NdJ("click",function(){return t.cancel()}),e._uU(6,"Cancel"),e.qZA(),e.TgZ(7,"button",3),e.NdJ("click",function(){return t.save()}),e._uU(8," Save "),e.qZA(),e.qZA(),e.TgZ(9,"div",4),e._uU(10),e.qZA(),e.qZA()),2&n&&(e.Q6J("ngIf","feature"!==t.data.card),e.xp6(1),e.Q6J("ngIf","feature"===t.data.card),e.xp6(1),e.Q6J("card",t.data.card)("link",t.data.link)("feature",t.data.feature?t.data.feature:null),e.xp6(8),e.Oqu(t.warning))},directives:[m.O5,h.uh,se,h.H8,y.lW],styles:[""]}),s}()}}]);
//# sourceMappingURL=9401.f597bff8583f26c0.js.map